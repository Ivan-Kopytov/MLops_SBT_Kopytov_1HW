# Проект SBT: Простая линейная регрессия с использованием PyTorch Lightning, Hydra и DVC

## Содержание
1. [Обзор проекта](#обзор-проекта)
2. [Структура проекта](#структура-проекта)
3. [Инструкции по настройке](#инструкции-по-настройке)
    - [Предварительные требования](#предварительные-требования)
    - [Клонирование репозитория](#клонирование-репозитория)
    - [Создание и активация виртуального окружения](#создание-и-активация-виртуального-окружения)
    - [Установка зависимостей](#установка-зависимостей)
4. [1HW: Создание и использование C++ расширения](#1hw-создание-и-использование-cрасширения)
    - [Сборка C++ расширения](#сборка-cрасширения)
    - [Использование C++ расширения в Python](#использование-cрасширения-в-python)
5. [2HW: Интеграция PyTorch Lightning, Hydra и DVC](#2hw-интеграция-pytorch-lightning-hydra-и-dvc)
    - [Настройка Hydra](#настройка-hydra)
    - [Реализация PyTorch Lightning модулей](#реализация-pytorch-lightning-модулей)
    - [Тренировка модели](#тренировка-модели)
    - [Настройка DVC для контроля версий](#настройка-dvc-для-контроля-версий)
    - [Управление чекпоинтами модели с помощью DVC](#управление-чекпоинтами-модели-с-помощью-dvc)
6. [Инструкции по использованию](#инструкции-по-использованию)
7. [Решение проблем](#решение-проблем)
8. [Дополнительная информация](#дополнительная-информация)

---

## Обзор проекта

Этот проект состоит из двух основных заданий:

- **1HW**: Создание C++ расширения для простой линейной регрессии и создание Python биндингов с использованием `pybind11`.
- **2HW**: Разработка тренировочного пайплайна с использованием PyTorch Lightning, управление конфигурациями с помощью Hydra и версионирование данных и артефактов модели с помощью DVC.

Проект интегрирует PyTorch Lightning для обучения модели, Hydra для управления конфигурациями и DVC для контроля версий данных и моделей, обеспечивая воспроизводимость и удобство работы.

## Структура проекта

SBT/ ├── .git/ ├── .dvc/ ├── .gitignore ├── conf/ │ ├── config.yaml │ ├── data.yaml │ ├── model.yaml │ └── train.yaml ├── 1HW/ │ ├── CMakeLists.txt │ ├── Dockerfile │ ├── README.md │ ├── bindings.cpp │ ├── build/ │ ├── dist/ │ ├── dist.dvc │ ├── linear_regression.cpp │ ├── pyproject.toml │ ├── setup.py │ ├── simple_linear_regression.cpython-312-x86_64-linux-gnu.so │ ├── simple_linear_regression.egg-info/ │ └── test_script.py ├── 2HW/ │ ├── checkpoints/ │ ├── checkpoints.dvc │ ├── conf/ │ │ ├── config.yaml │ │ ├── data.yaml │ │ ├── model.yaml │ │ └── train.yaml │ ├── data_module.py │ ├── dataset.py │ ├── model_module.py │ ├── outputs/ │ ├── simple_linear_regression.cpython-312-x86_64-linux-gnu.so │ └── train.py └── remote_storage/ └── files/ └── md5/ └── d7/ └── 51713988987e9331980363e24189ce.dir

diff
Копировать код

- **1HW/**: Содержит файлы, связанные с C++ расширением и его Python биндингами.
- **2HW/**: Содержит тренировочный пайплайн с использованием PyTorch Lightning, Hydra и DVC.
- **conf/**: Конфигурационные файлы для Hydra.
- **remote_storage/**: Директория, предназначенная для удалённого хранилища DVC.

## Инструкции по настройке

### Предварительные требования

Убедитесь, что у вас установлены следующие инструменты:

- **Python 3.12** или выше
- **C++ компилятор** (например, `g++`)
- **CMake** (для сборки C++ расширения)
- **Git**
- **Docker** (опционально, если требуется)

### Клонирование репозитория

Если проект хранится в удалённом репозитории, клонируйте его:

```bash
git clone <URL_репозитория>
cd SBT
Создание и активация виртуального окружения
Создайте и активируйте виртуальное окружение для изоляции зависимостей:

bash
Копировать код
python3 -m venv venv
source venv/bin/activate
Установка зависимостей
Установите необходимые Python зависимости для проекта:

bash
Копировать код
pip install --upgrade pip
pip install pybind11 pytorch-lightning hydra-core dvc
1HW: Создание и использование C++ расширения
Сборка C++ расширения
Перейдите в директорию 1HW:

bash
Копировать код
cd 1HW
Сборка расширения с помощью CMake и Make:

Создайте директорию для сборки, затем выполните сборку.

Использование C++ расширения в Python
Убедитесь, что файл .so доступен:

Файл расширения должен находиться в директории 1HW/.

Скопируйте файл .so в директорию 2HW:

Переместите или скопируйте файл расширения в директорию 2HW/ для использования в тренировочном пайплайне.

2HW: Интеграция PyTorch Lightning, Hydra и DVC
Настройка Hydra
Создайте директорию конфигураций:

bash
Копировать код
mkdir -p 2HW/conf
Создайте основные конфигурационные файлы:

В директории conf/ создайте файлы config.yaml, data.yaml, model.yaml и train.yaml с необходимыми настройками.

Реализация PyTorch Lightning модулей
Создайте data_module.py:

Реализуйте LightningDataModule для управления данными, включая загрузку и подготовку данных для обучения и валидации.

Создайте model_module.py:

Реализуйте LightningModule для модели линейной регрессии, определив архитектуру модели, функцию потерь, шаги обучения и валидации, а также оптимизатор.

Тренировка модели
Создайте скрипт train.py:

Разработайте скрипт для запуска процесса обучения, используя настройки из конфигурационных файлов Hydra. Добавьте колбэк для сохранения чекпоинтов модели.

Запустите тренировку:

Выполните скрипт train.py, чтобы начать процесс обучения модели. Чекпоинты модели будут сохраняться в указанную директорию.

Настройка DVC для контроля версий
Инициализация Git в корневой директории:

Убедитесь, что Git репозиторий инициализирован в корне проекта SBT/.

Настройка .gitignore:

Создайте или обновите файл .gitignore, чтобы исключить из Git ненужные файлы и директории, такие как виртуальное окружение, временные файлы, артефакты сборки и директории DVC.

Добавление файлов в Git и первый коммит:

Добавьте все файлы в Git и выполните первый коммит.

Инициализация DVC в корневой директории:

Инициализируйте DVC, чтобы начать управление версиями данных и артефактов модели.

Управление чекпоинтами модели с помощью DVC
Добавление артефактов под контроль DVC:

Используйте команды DVC для отслеживания директорий с чекпоинтами моделей и другими артефактами.

Настройка удалённого хранилища для DVC:

Настройте удалённое хранилище (например, локальное или облачное) для хранения больших файлов данных и моделей.

Отправка данных в удалённое хранилище DVC:

Выполните команду dvc push для загрузки отслеживаемых файлов в удалённое хранилище.

Добавление изменений в Git и коммит:

Закоммитьте изменения, связанные с DVC, в Git репозиторий.

Инструкции по использованию
Клонирование репозитория:

Клонируйте репозиторий и перейдите в директорию проекта.

Активация виртуального окружения:

Активируйте ранее созданное виртуальное окружение.

Установка зависимостей:

Установите необходимые зависимости, используя pip.

Настройка DVC удалённого хранилища (если ещё не настроено):

Добавьте удалённое хранилище для DVC и выполните dvc pull для загрузки данных.

Запуск тренировки модели:

Перейдите в директорию 2HW и запустите скрипт train.py для начала процесса обучения модели.

Просмотр чекпоинтов:

Чекпоинты модели сохраняются в директорию 2HW/checkpoints/. Для доступа к ним используйте команды DVC.

Решение проблем
Ошибка при импорте Hydra
Описание: Hydra не может найти директорию конфигураций.

Решение: Убедитесь, что директория conf/ существует и содержит файл config.yaml.

Ошибка с параметром gpus в PyTorch Lightning
Описание: Параметр gpus не распознан при инициализации Trainer.

Решение: В новых версиях PyTorch Lightning замените параметр gpus на accelerator и devices в конфигурационных файлах и коде.

Ошибка при инициализации DVC
Описание: DVC не может инициализироваться, так как проект не отслеживается системой контроля версий.

Решение: Инициализируйте Git репозиторий перед инициализацией DVC:

bash
Копировать код
git init
dvc init
Дополнительная информация
Hydra: Управление конфигурациями. Документация Hydra
PyTorch Lightning: Упрощённый интерфейс для обучения моделей. Документация PyTorch Lightning
DVC: Контроль версий данных и моделей. Документация DVC
pybind11: Создание Python биндингов для C++. Документация pybind11
Git: Система контроля версий. Документация Git
Автор: Ваше Имя
Контакт: your.email@example.com

Копировать код





